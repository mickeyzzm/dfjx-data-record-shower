webpackJsonp([15],{PBs5:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("zS+P"),s=o("j1XB"),l=o("+cKO"),r=(o("slU3"),{name:"RoleMain",data:function(){return{userDataList:[],termForSearch:"",tableDataUrl:"sys/role/rolePageData",currPageNum:1,totalPage:1,showModalPage:!1,showRoleFunction:!1,isEditModal:!1,edit_role_id:null,formData:{user_role_id:null,user_role_name:null},roleFunctionData:[],menuCheckedForRole:[]}},validations:{formData:{user_role_name:{required:l.required}}},computed:{modalPageTitle:function(){return null!==this.formData.user_role_id?"修改角色":"新增角色"}},components:{WorkTablePager:a.a,WorkMain:s.a},methods:{getTableData:function(e){e&&""!==e?this.currPageNum=e:e=this.currPageNum;var t=this;this.BaseRequest({url:this.tableDataUrl,method:"get",params:{currPage:e,pageSize:10,search:this.termForSearch||""}}).then(function(e){t.totalPage=e.totalPage,t.refreshTableList(e.dataList)})},refreshTableList:function(e){this.userDataList=e},delRole:function(e){var t=this;this.$confirm("确定删除角色【"+e.user_role_name+"】？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,type:"warning"}).then(function(){t.BaseRequest({url:"sys/role/deleteRole",method:"get",params:{user_role_id:e.user_role_id}}).then(function(){t.Message.success("删除成功"),t.getTableData()})}).catch(function(){})},openAddModal:function(){this.clearData(),this.showModalPage=!0,this.isEditModal=!0},openEditModal:function(e){this.formData.user_role_id=e.user_role_id,this.formData.user_role_name=e.user_role_name,this.showModalPage=!0,this.isEditModal=!0},clearData:function(){this.formData.user_role_id=null,this.formData.user_role_name=null},closeModal:function(){this.showModalPage=!1,this.isEditModal=!1},closeRoleMenus:function(){this.showRoleFunction=!1},openRoleFunction:function(e){this.showRoleFunction=!0,this.edit_role_id=e.user_role_id;var t=this;this.BaseRequest({url:"sys/roleMenu/getMenuByRole",method:"get",params:{user_role_id:e.user_role_id}}).then(function(e){t.menuCheckedForRole=[],null!=e&&e.length>0&&e.forEach(function(e){t.menuCheckedForRole.push(e.module_id)})})},submitDataForm:function(){var e=this;this.checkInputNull()||(null!==this.formData.user_role_id?this.BaseRequest({url:"sys/role/updateSaveRole",method:"post",data:this.formData}).then(function(){e.Message.success("保存成功"),e.getTableData(),e.closeModal()}):this.BaseRequest({url:"sys/role/saveNewRole",method:"post",data:this.formData}).then(function(){e.Message.success("保存成功"),e.getTableData(),e.closeModal()}))},subRoleMenus:function(){var e=this;this.BaseRequest({url:"sys/roleMenu/saveMenusForRole",method:"post",data:{user_role_id:""+this.edit_role_id,menus:this.menuCheckedForRole}}).then(function(){e.Message.success("保存成功"),e.closeRoleMenus()})},checkInputNull:function(){var e=this.$v.$invalid;return e&&this.$notify({dangerouslyUseHTMLString:!0,message:'<span style="font-size:15px;color:red;font-weight: bold">以下参数不允许为空</span><br>角色编号<br>角色名称'}),e}},mounted:function(){this.userDataList=[],this.getTableData(1);var e=this;this.BaseRequest({url:"sys/menu/listMenuByPage",method:"GET",params:{currPage:"1",pageSize:"200"}}).then(function(t){t.dataList.forEach(function(t){e.roleFunctionData.push({key:t.module_id,label:t.module_name})})})}}),n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-row",{staticClass:"search-row",attrs:{gutter:20}},[o("el-col",{staticClass:"align-left",attrs:{span:17}},[o("el-button",{attrs:{type:"primary"},on:{click:e.openAddModal}},[e._v("新增")])],1)],1),e._v(" "),o("el-row",{staticClass:"table-page-root-outoptions"},[o("el-col",{attrs:{span:24}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userDataList}},[o("el-table-column",{attrs:{prop:"user_role_id",label:"角色ID"}}),e._v(" "),o("el-table-column",{attrs:{prop:"user_role_name",label:"角色名称"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(o){e.openRoleFunction(t.row)}}},[e._v("功能")]),e._v(" "),o("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(o){e.openEditModal(t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(o){e.delRole(t.row)}}},[e._v("删除")])]}}])})],1)],1)],1),e._v(" "),o("WorkTablePager",{attrs:{pageCount:e.totalPage},on:{refreshData:e.getTableData}}),e._v(" "),o("el-dialog",{attrs:{title:e.modalPageTitle,visible:e.showModalPage},on:{"update:visible":function(t){e.showModalPage=t}}},[o("el-form",{staticClass:"modal-form",attrs:{"label-width":"20%",model:e.formData}},[o("el-form-item",{attrs:{label:"角色编号"}},[o("el-input",{attrs:{disabled:e.isEditModal,"auto-complete":"off"},model:{value:e.formData.user_role_id,callback:function(t){e.$set(e.formData,"user_role_id",t)},expression:"formData.user_role_id"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"角色名称"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formData.user_role_name,callback:function(t){e.$set(e.formData,"user_role_name",t)},expression:"formData.user_role_name"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.closeModal}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitDataForm()}}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"角色功能",visible:e.showRoleFunction},on:{"update:visible":function(t){e.showRoleFunction=t}}},[o("el-transfer",{staticClass:"role-transfer",attrs:{titles:["未选功能","已选功能"],data:e.roleFunctionData},model:{value:e.menuCheckedForRole,callback:function(t){e.menuCheckedForRole=t},expression:"menuCheckedForRole"}}),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.closeRoleMenus}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.subRoleMenus()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var i=o("VU/8")(r,n,!1,function(e){o("n9r2")},"data-v-39e5679c",null);t.default=i.exports},n9r2:function(e,t){}});
//# sourceMappingURL=15.cb1a14b8eca4500b7c5f.js.map